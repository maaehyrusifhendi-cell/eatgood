<!-- Meal Intake Calculator Section (fully functional) -->
<section id="meal-calculator" style="background:#fff;">
  <h3 style="text-align:center;font-size:2em;color:#2e7d32;">
    Meal Intake Calculator (74 Nutrients)
  </h3>

  <div class="controls" style="text-align:center;margin-top:15px;">
    <label for="foodSelect">Food Item: </label>
    <select id="foodSelect" style="padding:5px;border-radius:4px;">
      <option value="">--Select Food--</option>
      <option>Hausa Koko</option>
      <option>Rice Porridge</option>
      <option>Corn Porridge</option>
      <option>Oblayo</option>
    </select>

    <label for="portion">Portion (g): </label>
    <input type="number" id="portion" value="100" min="1"
           style="width:80px;text-align:right;">
    <button id="addBtn"
            style="background:#2e7d32;color:white;border:none;
                   padding:8px 12px;border-radius:5px;">
      Add Food
    </button>
    <button id="resetBtn"
            style="background:#a5d6a7;color:#1b5e20;border:none;
                   padding:8px 12px;border-radius:5px;">
      Reset
    </button>
  </div>

  <div style="overflow-x:auto;margin-top:20px;">
    <table id="nutrientTable"
           style="width:100%;border-collapse:collapse;font-size:13px;">
      <thead>
        <tr style="background:#2e7d32;color:white;">
          <th>Food Item</th><th>Portion (g)</th>
          <th>Water (g)</th><th>Energy (kcal)</th>
          <th>Protein (g)</th><th>Fat (g)</th>
          <th>Carbohydrate (g)</th><th>Fibre (g)</th>
          <th>Ash (g)</th><th>Calcium (mg)</th><th>Iron (mg)</th>
          <th>Zinc (mg)</th><th>Vitamin A (µg)</th>
          <th>Thiamine (mg)</th><th>Riboflavin (mg)</th>
          <th>Niacin (mg)</th><th>Vitamin C (mg)</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr id="totalsRow"
            style="background:#e8f5e9;font-weight:bold;">
          <td colspan="2">Total</td>
          <td colspan="15"></td>
        </tr>
      </tfoot>
    </table>
  </div>

  <script>
    /* ---- Example nutrient data per 100 g ---- */
    const nutrientData = {
      "Hausa Koko": {
        "Water (g)":70,"Energy (kcal)":120,"Protein (g)":2.5,"Fat (g)":1.5,
        "Carbohydrate (g)":25,"Fibre (g)":1.8,"Ash (g)":0.5,"Calcium (mg)":22,
        "Iron (mg)":1.3,"Zinc (mg)":0.6,"Vitamin A (µg)":5,"Thiamine (mg)":0.03,
        "Riboflavin (mg)":0.02,"Niacin (mg)":0.4,"Vitamin C (mg)":0
      },
      "Rice Porridge": {
        "Water (g)":65,"Energy (kcal)":150,"Protein (g)":3,"Fat (g)":1,
        "Carbohydrate (g)":30,"Fibre (g)":1.2,"Ash (g)":0.4,"Calcium (mg)":15,
        "Iron (mg)":0.8,"Zinc (mg)":0.5,"Vitamin A (µg)":0,"Thiamine (mg)":0.04,
        "Riboflavin (mg)":0.03,"Niacin (mg)":0.7,"Vitamin C (mg)":0
      },
      "Corn Porridge": {
        "Water (g)":60,"Energy (kcal)":180,"Protein (g)":4,"Fat (g)":2,
        "Carbohydrate (g)":34,"Fibre (g)":2.5,"Ash (g)":0.6,"Calcium (mg)":20,
        "Iron (mg)":1.1,"Zinc (mg)":0.7,"Vitamin A (µg)":3,"Thiamine (mg)":0.05,
        "Riboflavin (mg)":0.04,"Niacin (mg)":0.9,"Vitamin C (mg)":0
      },
      "Oblayo": {
        "Water (g)":68,"Energy (kcal)":110,"Protein (g)":2.1,"Fat (g)":0.8,
        "Carbohydrate (g)":23,"Fibre (g)":1.7,"Ash (g)":0.4,"Calcium (mg)":18,
        "Iron (mg)":0.9,"Zinc (mg)":0.4,"Vitamin A (µg)":2,"Thiamine (mg)":0.02,
        "Riboflavin (mg)":0.02,"Niacin (mg)":0.3,"Vitamin C (mg)":0
      }
    };

    const tableBody = document.querySelector("#nutrientTable tbody");
    const totalsRow = document.getElementById("totalsRow");

    document.getElementById("addBtn").addEventListener("click", addFood);
    document.getElementById("resetBtn").addEventListener("click", resetTable);

    function addFood() {
      const food = document.getElementById("foodSelect").value;
      const portion = parseFloat(document.getElementById("portion").value);
      if (!food || !portion || !nutrientData[food]) {
        alert("Please select a valid food and portion size.");
        return;
      }
      const nutrients = nutrientData[food];
      const tr = document.createElement("tr");
      tr.innerHTML =
        `<td>${food}</td><td>${portion}</td>` +
        Object.keys(nutrients)
          .map(k => `<td>${((nutrients[k] * portion) / 100).toFixed(2)}</td>`)
          .join("");
      tableBody.appendChild(tr);
      updateTotals();
    }

    function updateTotals() {
      const rows = tableBody.querySelectorAll("tr");
      if (rows.length === 0) {
        totalsRow.innerHTML = "<td colspan='2'>Total</td><td colspan='15'></td>";
        return;
      }

      const keys = Object.keys(Object.values(nutrientData)[0]);
      const totals = Array(keys.length).fill(0);

      rows.forEach(row => {
        const tds = row.querySelectorAll("td");
        for (let i = 2; i < tds.length; i++) {
          totals[i - 2] += parseFloat(tds[i].textContent) || 0;
        }
      });

      totalsRow.innerHTML =
        "<td colspan='2'>Total</td>" +
        totals.map(v => `<td>${v.toFixed(2)}</td>`).join("");
    }

    function resetTable() {
      tableBody.innerHTML = "";
      updateTotals();
    }

    updateTotals(); // initialise totals row
  </script>
</section>
