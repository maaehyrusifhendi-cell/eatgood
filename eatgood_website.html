<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NutriWise 74-Nutrient Calculator</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f8faf8;
    color: #222;
    margin: 0;
    padding: 0;
  }
  header {
    background: #2e8b57;
    color: #fff;
    padding: 1rem;
    text-align: center;
  }
  main {
    padding: 1rem 2%;
  }
  .input-box {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
    margin-bottom: 1rem;
  }
  select, input {
    padding: .6rem;
    border: 1px solid #ccc;
    border-radius: .4rem;
    font-size: 1rem;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    overflow-x: auto;
    display: block;
  }
  th, td {
    border: 1px solid #e0e0e0;
    padding: .4rem .6rem;
    text-align: right;
    white-space: nowrap;
  }
  th {
    background: #e9f5ec;
    color: #256f45;
    position: sticky;
    top: 0;
  }
  td:first-child, th:first-child {
    text-align: left;
  }
  tr:nth-child(even) { background: #fdfdfd; }
  footer {
    text-align: center;
    font-size: .9rem;
    color: #555;
    padding: 1rem 0;
    margin-top: 2rem;
    border-top: 1px solid #ddd;
  }
</style>
</head>
<body>
<header>
  <h1>NutriWise 74-Nutrient Calculator</h1>
  <p>Per 1 g food basis • WHO/FAO RDA • Real-time Computation</p>
</header>

<main>
  <div class="input-box">
    <label for="foodSelect"><strong>Select Food:</strong></label>
    <select id="foodSelect"></select>

    <label for="grams"><strong>Enter Quantity (g):</strong></label>
    <input id="grams" type="number" min="0" step="0.1" placeholder="e.g. 120" />
  </div>

  <div class="table-container">
    <table id="nutrientTable">
      <thead>
        <tr id="nutrientHeader"></tr>
      </thead>
      <tbody id="nutrientBody"></tbody>
    </table>
  </div>
</main>

<footer>
  © 2025 NutriWise – Eat Smart, Live Healthy
</footer>
<script>
// === SAMPLE DATA extracted & rounded (replace or extend with full 68-nutrient set) ===
const foodData = {
  "Hausa koko": {
    "Water (g)": 0.14, "kcal": 1.22, "Protein (g)": 0.02, "Total fat (g)": 0.01,
    "Carbohydrates (g)": 0.25, "Iron (mg)": 0.01, "Calcium (mg)": 0.08
  },
  "Rice porridge": {
    "Water (g)": 0.72, "kcal": 0.98, "Protein (g)": 0.03, "Total fat (g)": 0.01,
    "Carbohydrates (g)": 0.22, "Iron (mg)": 0.02, "Calcium (mg)": 0.05
  },
  "Cornflakes": {
    "Water (g)": 0.03, "kcal": 3.80, "Protein (g)": 0.08, "Total fat (g)": 0.01,
    "Carbohydrates (g)": 0.84, "Iron (mg)": 0.10, "Calcium (mg)": 0.07
  }
  // … embed all remaining foods from your Excel here …
};

// === WHO/FAO adult RDA reference (approximate) ===
const RDA = {
  "Water (g)": 2700, "kcal": 2000, "Protein (g)": 50,
  "Total fat (g)": 70, "Carbohydrates (g)": 310,
  "Iron (mg)": 18, "Calcium (mg)": 1000
  // … add other nutrients as needed …
};

// Helper: generate header columns dynamically
const nutrientList = Object.keys(Object.values(foodData)[0]);
const headerRow = document.getElementById("nutrientHeader");
headerRow.innerHTML = "<th>Nutrient</th><th>Intake (g/kcal)</th><th>% RDA</th>";
</script>
<script>
const foodSelect = document.getElementById("foodSelect");
const gramsInput = document.getElementById("grams");
const body = document.getElementById("nutrientBody");

// populate dropdown
Object.keys(foodData).forEach(f => {
  const opt = document.createElement("option");
  opt.value = f; opt.textContent = f;
  foodSelect.appendChild(opt);
});

function updateTable() {
  const food = foodSelect.value;
  const grams = parseFloat(gramsInput.value) || 0;
  const nutrients = foodData[food];
  body.innerHTML = "";

  for (let n in nutrients) {
    const valPerGram = nutrients[n];
    const intake = valPerGram * grams;              // intake amount
    const rda = RDA[n] || 0;
    const pct = rda ? (intake / rda) * 100 : 0;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${n}</td>
      <td>${intake.toFixed(2)}</td>
      <td>${pct.toFixed(2)}%</td>`;
    body.appendChild(row);
  }
}

foodSelect.addEventListener("change", updateTable);
gramsInput.addEventListener("input", updateTable);

// initialise
foodSelect.selectedIndex = 0;
updateTable();
</script>
</body>
</html>
import re, json
from pathlib import Path
from openpyxl import load_workbook

excel_path = Path("Nutrient analysis template3333.xlsx")
html_path  = Path("nutriwise.html")

wb = load_workbook(excel_path, data_only=False)

def excel_to_js(expr):
    """Convert Excel formula syntax to JS syntax (rough 1:1)."""
    expr = expr.lstrip("=")
    expr = re.sub(r"([A-Za-z]+)([0-9]+)", r"\1\2", expr)   # keep coords literal
    expr = expr.replace("^", "**")
    expr = expr.replace(";", ",")
    expr = expr.replace(",", "+") if "SUM" in expr else expr
    expr = re.sub(r"SUM\(([^)]+)\)", r"(\1)", expr)
    return expr

all_js_lines = []

for ws in wb.worksheets:
    for row in ws.iter_rows():
        for cell in row:
            if isinstance(cell.value, str) and cell.value.startswith("="):
                js_expr = excel_to_js(cell.value)
                line = f"let {cell.coordinate} = {js_expr};"
                all_js_lines.append(line)

# --- Build minimal NutriWise HTML skeleton ---
html_head = """<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NutriWise Calculator</title>
<style>
body{font-family:Segoe UI,Arial;background:#f8faf8;color:#222;margin:0}
header{background:#2e8b57;color:#fff;text-align:center;padding:1rem}
table{border-collapse:collapse;width:100%;font-size:13px}
th,td{border:1px solid #ddd;padding:4px 6px;text-align:right}
th{background:#e9f5ec;color:#256f45}
</style>
</head><body>
<header><h1>NutriWise Nutrient Calculator</h1></header>
<main><p>Auto-generated from Excel formulas</p>
<script>
"""
html_tail = """
</script>
</main>
<footer style="text-align:center;padding:1rem;border-top:1px solid #ddd">
© 2025 NutriWise – Eat Smart, Live Healthy
</footer>
</body></html>
"""

with open(html_path, "w", encoding="utf-8") as f:
    f.write(html_head)
    for line in all_js_lines:
        f.write(line + "\n")
    f.write(html_tail)

print(f"✅ Done! Created {html_path} with {len(all_js_lines)} formulas.")
